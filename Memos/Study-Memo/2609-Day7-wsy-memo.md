#### 路演报告反馈

共性问题：

1. 股票池策略较多，择时很朴素

2. 缺少对其他品种的尝试

3. 大部分策略主要是beta收益（牛市阶段赚得多，熊市亏，起伏；缺乏对冲的手段；但A股的特性，牛短熊长，所以策略的回撤时间过长，对量化交易来说不太合适）

4. 策略的检验不够完备

   对交易记录的分析不够完备，缺乏对重点交易的交易记录的分析（盈利和亏损可能就来自于其中的小部分，应当有针对的分析原因）

5. 到处都是拟合的痕迹（其实单边收益的就很好？哪怕是直线下跌的策略+反向）

6. 缺少交易型的策略

   现实中常做类固收，尽管年化不高，从每个月结算到账的时候是不回撤的——非常受风险偏好低的投资者的偏好。需要通过交易型策略达到，通过股票池是很难避免回撤的。



### 复习

股票池+择时：赚取$r_p,\alpha \& \beta$的收益

更追求：无论市场行情如何，都能赚钱。$\alpha_p$收益与大盘波动无关。

- Alpha策略：只赚取alpha的部分，对冲掉大盘波动

- 股票alpha策略：	
  - 做多股票组合：Alpha+beta
  - 做空股指期货：-Beta

- 股指期货

  保证金交易

  ​	IF～HS300，名义本金=一个指数点\*300，保证金=名义本金*10%

  ​	1手，100股（100指数点？）的保证金

  加杠杆

- 信息率：反映主动投资能力的指标

  - $IR=\alpha/\omega$
  - $\alpha$，主动收益；$\omega$，多付出的主动风险
  - 对比夏普率：总收益/总风险
  - 信息率意味着主动承担了相对于基准组合的风险敞口，带来了多少的超额收益
  - 信息率低于0.5，就不要购买了；高于1，非常优秀；0.5-1，中庸之辈

- Alpha & Beta 后验算法

  - $r_P(t)=\beta_P\cdot r_B(t)+\alpha_P+\epsilon_P(t),t=1,2,\cdots ,T$

    $r_P$，组合P的超额收益率

    $r_B$，业绩基准组合B的超额收益率（可以选择沪深300）

    $\theta_P(t)=\alpha_P+\epsilon_P(t)$，残差

    $\epsilon(t)$，期望为0的随机项

    $\beta_P=\frac{cov(r_P,r_B)}{var(r_B)}$，代入$t=1,2,\cdots ,T$的数据可得

    $\alpha_P=E[\theta_P(t)]=E[r_P(t)]-\beta_PE[r_B(t)]$

  - 组合风险：$\sigma_P=\sqrt{\frac{1}{T}\sum_{t=1}^Tr_P^2(t)-\frac{1}{T}\sum_{t=1}^Tr_P(t)\cdot \frac{1}{T}\sum_{t=1}^Tr_P(t)}$

    残叉风险：$\omega_P=\sqrt{\sigma_P^2-\beta_P^2\cdot \sigma_B^2}$

  - 计算周净值序列计算出后验的指标，$\alpha,\sigma_P,\omega_P$需要年化，$\beta$不需要



### 精细的量化信号系统

- 常见技术指标的分类
  - 均线型
  - 趋势型
  - 摆动型
  - 能量型

- 均线

- MACD

  DIF: EMA(CLOSE,SHORT)-EMA(CLOSE,LONG)，比真实价格变动滞后

  DEA: EMA(DIF,MID)。通常DIF和DEA同时上涨时，价格趋势已经形成

  注：EMA为指数加权平均（滑动平均），使得变量的更新与一段时间内的历史取值有关

  金叉死叉：DIF与DEA的交叉点。DIF上穿DEA，金叉

  MACD：`(DIF_DEA)*2,COLORSTICK`，*2是经验值，为了让图像看看起来舒服

- KD-随机指数

  $\%K=100\times\frac{Close-\min_nLow}{\max_nHigh-\min_nLow}$

  表示收盘价在窗口的什么位置（1，在最高价；0，在最低价）

  为什么价格猛涨导致了指标钝化（涨速过大）

  再平滑，$\%D=MA(\%K,N)$

  超卖（KD低钝化），容易在超卖处形成金叉，买入；超买（KD高钝化），容易在超买处形成死叉，卖出

- RSI-相对强弱指数

  $RSI=100\times\frac{\sum_1^n\max{(Close-LC),0}}{\sum_1^n|Close-LC|}$

  LC, last close

  分子，把所有的阳线累计

  RSI接近100，难以判断：取决于反转观点/趋势跟随观点

  ​	指标没有给出这么做，是交易逻辑决定的

- 技术指标的应用技巧
  - 信号
    - 突破
      - 价格突破
      - 指标突破
    - 交叉
    - 背离：和突破、交叉的区别在于有二次验证
      - 顶背离（bulllish divergence）：尽管价格再创新高，但指标在下降，有些人把底背离作为做空的信号。
      - 底背离（bearish divergence）：尽管价格创新低，但指标在上升，有些人把顶背离作为做多信号
  - 用途
    - 预警（不一定出信号就一定有行动）
    - 确认（之前的买入卖出策略是否正确，是否有止损措施）
    - 预测（未来的涨跌幅度）
  - 决策（取决于交易观点）
    - 趋势跟随
    - 高抛低吸
    - ……
  - 动作
    - 买入
    - 卖出
    - 观望

- 更多交易决策依据
  - 基本面指标
  - 资金流向指标
    - 在港交所主动购买上交所/深交所的股票（北向）
    - reverse
- 胜率赔率决定了期望收益，还差
  - 交易成本的影响
  - 持仓周期，资金利用率与年化收益
  - 交易机会的多少与交易频次
  - 资金管理和风险控制

- 多技术指标的融合
  - 不要都选一种类型的指标
  - 概率思维，无论怎样组合都很难准确、长期的把控市场

- MACD的编程实现

  - 检验顶底背离：用DIF作为指标

  一些可能的问题（老师提供了代码）：

  - DIF有滞后效应，比如，价格创新高了，但DIF还没达到新高。对齐？
  - 当价格和指标的误差在几个bar的范围之内可以看作一致的信号
  - 如何处理价格的各种噪声的干扰
  - 不是显著的背离，对触发交易没什么贡献，如何过滤/设置阈值作为显著的程度
  - 对价格的引用，最好不要用当前bar的收盘价（因为还没收盘，所以一直在变动，容易出现信号）。如果一定要用最新价格来判断的话，可以用最高价/最低价（单边变动），一旦满足要求，信号不会消失
  - 可变因素的处理

- 一些例子：？

  贴水：IF价格远低于HS300的价格；做空IF，如果处于长期贴水状态，例如IF为4900点，每月有一次交割，如果这个月HS300完全没波动保持在5000点，而IF的交割价格=交割日下午1-3点股指HS300的均价，交割价就是5000点，交割导致亏损100点。



K线形态组合

- 圆弧底：在足够低的位置，主力资金（多种资金的合力）没有出货的需求，价格较低没什么利润且没人买，怕被其他的主力机构反向收割，所以把散户在底部反复揉搓一两周，再有一次反弹的机会很多人就赶紧买出了。得到了筹码的充分交换，形成碗底。而上涨的过程也是逐渐放量、不断反复，但是比双底的结构更安全一些。也有利用反向逻辑在上涨时再收割一批技术派。

- 如果按照K线形态做交易最好选择大盘股

- 检验每种说法的可靠性，在什么边界条件下更有效/会失效？


- 震荡突破

  $Eff(effectiveness)=(H-L)/\sum_i(H_i-L_i)$

  H，区间最高价；L，区间最低价

  长期很盘的话，比较小；因为长期趋势不大，但每天累计起来很大

  横盘的趋势效率低（接近0），震荡区间的趋势效率高

- RSRS（resistance support relative strength）

  -  做一个一元线性回归OLS：

    上涨遇阻力 下跌无支撑：beta<1

    上涨破阻力 下跌有支撑：beta>1

    

所有能看到的都是想让我们看到的，不一定是最准确的数据