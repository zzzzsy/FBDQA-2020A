# 第七周课堂小结

2018012611 【2020.10.30】

构造更精细的信号系统：以量化的角度重新认识技术指标

1. 课堂展示点评

   - 股票池策略较多，择时很朴素
   - 缺少对其他品种的尝试
   - 大部分策略主要是beta收益：由于A股牛短熊长，所以大部分策略的回撤时长太长（主观交易可以，但是量化交易不行，要获取绝对收益）
   - 策略的检验不够完备：对重点交易记录的分析（过拟合/程序bug？
   - 拟合的痕迹多：做不到单边
   - 缺少交易型的策略：如何实现类固收产品，每个月都没有回撤，收益超过年化6个点

2. 超额收益的检验：后验alpha分解

   - Alpha策略：如何把 $$\beta_p$$ 对冲掉，保留$$\alpha_p$$部分

   - 做多股票组合+做空股指期货（只有套保盘不够）=组合超额收益

   - IF~HS300，一个指数点*300=名义本金，保证金交易：保证金=本金的10%

   - 创建一个投资组合，使它相对于HS300，有一个敞口的暴露（有的股票比HS300的权重买的多，有的买的少），它的规模等于HS300指数*300，同时卖空IF，相当于当期净头寸=0，这样就可以长期跑赢指数

   - 信息率：$$IR=\frac{\alpha}{\omega}$$ 每付出一块钱的主动收益/主动风险，意味着主动承担了相对于基准组合的风险敞口，带来多少超额收益，而夏普比率是总收益/总风险

   - 信息率低于0.5：不考虑，信息率高于1：非常优秀

     

3. 常见技术指标

   不要迷信

   - 从量化的视角看指标

   - 分类：均线型、趋势型、摆动型、能量型

   - 程序化代码：（东方财富）

     - DIF: EMA(CLOSE,SHORT)-EMA(CLOSE,LONG) 指数滑动平均，short（通常是12）或long（通常是26）指的是过去多少个K线作为窗口，short反应的速度比long块，价格上涨时DIF也会上涨，但是比真实价格滞后

     - DEA: EMA(DIF,MID) 通常DIF和DEA同时上涨时，价格上涨趋势已经形成了。一般金叉：DIF上穿DEA

     - MACD: (DIF-DEA)*2,COLORSTICK: 大于0是红线小于0是绿线，为什么乘以2？画图时看得舒服…

     - KD-随机指数

       ​	$$\%K = 100 \times \frac{Close - min_n Low}{max_n High - min_n Low}$$

       ​	%D = MA(%K,N) 均值

     - RSI-相对强弱指数

- $$
  LSI = 100 \times \frac{\sum^n_i Max(close-LC)}{\sum^n_i |close-LC|}
  $$

  - 分子：所有阳线（今天收盘价高于昨天的）累计收益

  - LC：last close
  - 越接近100说明过去n跟K线上涨的多，越接近0说明下跌的越多
  - 技术指标的应用技巧
    - 信号：突破、交叉、背离
    - 顶背离/底背离：顶背离（bullish divergence）：价格创新高，但是指标下降，有人把顶背离作为做空信号；底背离（bearish divergence）：价格创新低，但是指标上升，有人把底背离作为做多信号
      - 编程：至少需要3跟K线才能判断价格局部高点，价格和指标的高点对齐允许一定偏差
      - 如何排除价格的毛刺/噪声的干扰
      - 给定两次高点的距离：不能太近？
      - 不显著的背离对触发交易没什么贡献，如何设置阈值过滤显著程度
      - 对价格的引用：最好不要用当前bar的最后收盘价（因为还没收盘，所以一直在变动，容易出现信号），最新价最好用最高/低价，因为它只能单边地动，一旦满足要求信号不会消失
  - 更多交易指标：基本面、技术面、资金流向（北向资金流入：在港交所主动流向A股的资金）



4. 量化趋势型技术指标

   - MACD的金叉、死叉、顶底背离

   - 连接白线（DIF）顶点

   - 信号闪烁怎么办？信号有效吗？
   
   - 贴水：IF价格远低于HS300的价格；做空IF，如果处于长期贴水状态，例如IF为4900点，每月有一次交割，如果这个月HS300完全没波动保持在5000点，而IF的交割价格=交割日下午1-3点股指HS300的均价，交割价就是5000点，交割导致亏损100点。
   
   - 收益分布直方图：用底背离作为买入信号，分别持有4/8/16/20/24小时 如果收益直方图都不能带来正收益（正偏分布），那就不太可能挣钱



5. 进一步认识K线形态组合

   - 经典价格形态

   - 圆弧底：在足够低的位置，主力资金（多种资金的合力）没有出货的需求，价格较低没什么利润且没人买，怕被其他的主力机构反向收割，所以把散户在底部反复揉搓一两周，再有一次反弹的机会很多人就赶紧买出了。得到了筹码的充分交换，形成碗底。而上涨的过程也是逐渐放量、不断反复，但是比双底的结构更安全一些。也有利用反向逻辑在上涨时再收割一批技术派。

   - 如果按照K线形态做交易最好选择大盘股

   - 检验每种说法的可靠性，在什么边界条件下更有效/会失效？

   - 震荡突破：$$Eff=\frac{(H-L)}{\sum_i(H_i-L_i)}$$

     ​	Effectiveness=整个区间的最高价-最低价/每根K线的最高价-最低价之和

     ​	横盘的趋势效率低（接近0），震荡区间的趋势效率高

   - RSRS（resistance support relative strength）：过拟合的研报…

     ​	做一个一元线性回归OLS：

     ​	上涨遇阻力 下跌无支撑：beta<1

     ​	上涨破阻力 下跌有支撑：beta>1