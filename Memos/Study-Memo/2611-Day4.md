# 第四周课堂小结

2018012611【2020.10.09】

## 金融基础知识

1. 金融基础概念

   - 金融学广义定义：研究**跨期**（r）配置**稀缺资源**（价格）的一门学科（时间上的决策/预期）
   - 学科分类：公司金融（融资端，公司的财务决策） + 资产定价（投资端，接近本课）
   - 金融学的假设与概念
     - 理性人假说：所有人都最大化自己的效用（趋利避害）
     - 边界条件：资源的稀缺性 & 制度费用
     - 基本原理：收益与风险的权衡、边际效用递减
     - 四大理论支柱：有效市场假说（Fama）、均值方差组合、CAPM、期权定价公式

2. 金融市场与制度

   - 直接/间接（银行贷款）融资
   - 一级/二级市场
   - 股票/债券/衍生品市场

3. 资产定价与投资学

   - 流动性：变现的难易程度以及成交价格的波动幅度；流动性递减的顺序往往也是风险递增的顺序
   - 交易制度：T+1，涨跌停，卖空限制，交易成本，竞价原则，竞价方式，证交所（新三板不属于A股），股指
   - 金融资产定价：$$ PV=\sum_{t=0}^n \frac{CF_t}{(1+r)^t}$$ 未来现金流折现
   - 资产收益率的影响因素：主要是久期和信用，股票收益率=无风险利率+风险溢价

4. CAPM模型

   - CAPM单因子：mkt

   - Fama-French三因子：smb、hml、mkt

   - Carhat四因子：加入momentum

   - Fama-French五因子：size、value、profit、investment、market

   - 投资组合理论：mean-variance: efficient frontier的切线，找sharpe ratio最大的组合

   - $总风险^2 = 系统性风险^2 + 公司风险^2 $

   - 区分$$ E(R) - r_f:$$ risk premium溢价 和  $$ \alpha: $$ 超额收益

     

## 聚宽

### 本地数据

1. 价格数据：get_price()
2. 财务数据：get_fundamentals()
   - date和statDate不能共存
3. 股票收益率
   - $$ R_t = \frac{P_t-P_{t-1}}{P_{t-1}}$$
   - 对数形式： $$ r_t = ln(1+R_t)=ln(\frac{P_t}{P_{t-1}})$$



## 量化交易策略开发案例

回顾海龟交易法！

### 如何选择适合的实践平台

1. 聚宽：从股票入门

2. 聚宽编程框架
   - 启动：initialize() 只调用一次的初始化策略
   - 开盘前：`run_daily(pl_before_market_open,time='before_open')` 
     - run_daily是系统函数，pl开头的是用户自己定义的函数
   - 盘中：` run_daily(pl_trade,time='every_bar')`每一个k线过来时调用一次，根据交易频率自动调用pl_trade函数，处理交易逻辑，可以选择day\minute\tick……
     - 计算择时信号，进行买卖操作
   - 收盘后：`run_daily(pl_after_market_close,time='after_close')`

​       趋势型策略关注赔率，均值回复型策略关注胜率，头寸分配是重中之重

3. 股票池
   - 股票池择时策略（基础）：构造优质股票的集合，等待择时信号来临
   - 三要素：选股条件、再平衡、容量
     - ROE分析、杜邦分析（高ROE有可能杠杆也高，风险高）
   - 构建股票池：
     - 初始化全局变量(g.)：`pl_init_lobal(context)`
     - 先卖-分配头寸-后买
     - continue是不做任何操作，不要它

4. 择时
   - 均线型
   - 双均线择时策略：
     - 5日均线：近5日收盘价/指数的平均值
     - 5日均线：短时；30日均线：长时
     - 金叉买入：5日均线从下往上穿过长时均线；死叉卖出：日均线从上往下穿过长时均线
     - 例子里pl_cross：大于零是金叉，小于零是死叉（如果昨天短线>长线，而前天短线和长线相等，那么再往前找一天，如果大前天短线<长线，仍然可以判断是金叉）

